apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: frontend-binding
  namespace: ecommerce
  labels:
    app: frontend
    component: rbac
subjects:
- kind: ServiceAccount
  name: frontend-sa
  namespace: ecommerce
roleRef:
  kind: Role
  name: frontend-role
  apiGroup: rbac.authorization.k8s.io

---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: api-gateway-binding
  namespace: ecommerce
  labels:
    app: api-gateway
    component: rbac
subjects:
- kind: ServiceAccount
  name: api-gateway-sa
  namespace: ecommerce
roleRef:
  kind: Role
  name: api-gateway-role
  apiGroup: rbac.authorization.k8s.io

---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: user-service-binding
  namespace: ecommerce
  labels:
    app: user-service
    component: rbac
subjects:
- kind: ServiceAccount
  name: user-service-sa
  namespace: ecommerce
roleRef:
  kind: Role
  name: backend-service-role
  apiGroup: rbac.authorization.k8s.io

---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: product-service-binding
  namespace: ecommerce
  labels:
    app: product-service
    component: rbac
subjects:
- kind: ServiceAccount
  name: product-service-sa
  namespace: ecommerce
roleRef:
  kind: Role
  name: backend-service-role
  apiGroup: rbac.authorization.k8s.io

---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: payment-service-binding
  namespace: ecommerce
  labels:
    app: payment-service
    component: rbac
subjects:
- kind: ServiceAccount
  name: payment-service-sa
  namespace: ecommerce
roleRef:
  kind: Role
  name: payment-service-role
  apiGroup: rbac.authorization.k8s.io

---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: monitoring-binding
  namespace: ecommerce
  labels:
    app: monitoring
    component: rbac
subjects:
- kind: ServiceAccount
  name: monitoring-sa
  namespace: ecommerce
roleRef:
  kind: Role
  name: monitoring-role
  apiGroup: rbac.authorization.k8s.io

---
# ClusterRoleBinding for cross-namespace monitoring
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: ecommerce-cluster-monitoring-binding
  labels:
    app: monitoring
    component: rbac
subjects:
- kind: ServiceAccount
  name: monitoring-sa
  namespace: ecommerce
roleRef:
  kind: ClusterRole
  name: ecommerce-cluster-monitoring
  apiGroup: rbac.authorization.k8s.io